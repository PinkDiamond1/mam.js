/* eslint-disable max-len */
import { address, checksumSecurity, digestFromSignature, digestFromSubseed, privateKeyFromSubseed, signature, subseed } from "../../src/signing/iss-p27";
import { TrytesHelper } from "../../src/utils/trytesHelper";

test("subseed() returns correct hashed version of trits securityLevel 0", () => {
    const res = subseed(TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"), 0);
    expect(TrytesHelper.fromTrits(res)).toBe("YRXSRVLUUSQHFMQQHIQOYDYOTPYUOY9SHFOHHN9GQEFVBMBSRHT9UQRRGHZNVXBZOTTDABNA9TANIF9AG");
});

test("subseed() returns correct hashed version of trits securityLevel 1", () => {
    const res = subseed(TrytesHelper.toTrits("MFCK9SDUFIOHDDMLCTMSULXXNCPKDVFOFKHOALA9EJFIZZA9TKKBWPQDXHEHHXXYXVSEDUEHVGOAEKABM"), 1);
    expect(TrytesHelper.fromTrits(res)).toBe("YULGY9GJAXQDAORVFCMGZQEHGDDRZPUKZBZ9RDPENUEGBTUTX9QZCOMMIXFU9OHFLJZF9YKGKJVLCQLHZ");
});

test("subseed() returns correct hashed version of trits securityLevel 2", () => {
    const res = subseed(TrytesHelper.toTrits("MFCK9SDUFIOHDDMLCTMSULXXNCPKDVFOFKHOALA9EJFIZZA9TKKBWPQDXHEHHXXYXVSEDUEHVGOAEKABM"), 2);
    expect(TrytesHelper.fromTrits(res)).toBe("AQPHUPQHMVPYXDYRGZKVGIOLJNC9KAAFRCPQBMULBWSVCJDWSVBAFFWEJWRAAHWYOLMCDASALLGRYSANW");
});

test("digestFromSubseed() returns correct hashed version of trits security level 1", () => {
    const res = digestFromSubseed(TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"), 1);
    expect(TrytesHelper.fromTrits(res)).toBe("IBIBQNBGFUJSSTQNEOJNGIYYWQDNNWAQ9JBEHI9CDVVTGSTKBEOVL9PNN9RXBLOEEH9ONALVX9KERZZAL");
});

test("digestFromSubseed() returns correct hashed version of trits security level 2", () => {
    const res = digestFromSubseed(TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"), 2);
    expect(TrytesHelper.fromTrits(res)).toBe("EJRGHCEWJUWUKC9ETGSPWCBUWDLJNYUJOOHQMWXUGFOTDCFCIYCTUNRKQUFSFKBSBJDZTZDS9B9FQUJAD");
});

test("digestFromSubseed() returns correct hashed version of trits security level 3", () => {
    const res = digestFromSubseed(TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"), 3);
    expect(TrytesHelper.fromTrits(res)).toBe("RWRBHIHFHAAESXGCIEWPW9YPYBTWSHDLYSCSSOLKTQUN9XXOIG9HFCJYGXKHRMBUNWMMQFOZXJY9XMWJR");
});

test("address() returns correct hashed version of trits", () => {
    const res = address(TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"));
    expect(TrytesHelper.fromTrits(res)).toBe("YRXSRVLUUSQHFMQQHIQOYDYOTPYUOY9SHFOHHN9GQEFVBMBSRHT9UQRRGHZNVXBZOTTDABNA9TANIF9AG");
});

test("privateKeyFromSubseed() returns correct hashed version of trits security level 1", () => {
    const res = privateKeyFromSubseed(TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"), 1);
    expect(TrytesHelper.fromTrits(res)).toBe("DRAORNOROUYSLTULDTBUSROKZFFXLXIUAPNFGDLEFSOYELCPMGITXGVTEDTZTMAOI9ZSYNNTUROHXDFFWMRKNXIQDLYYDHTWUONUJQYWRWIIWFXBNZPJBPNFRTCNJBRXCOWPXCXTJJGYMIT9HPVMXCJL9HOO9MXCNAZTGAUQHBBGAUDPWQNBXUQVVEVSFLZTSPGSVFBDDPHDCKUJBTYYCDBKSHCOELWNOULGZQAPZZNKOVQFYTGN9EEZVMXSIN9PZSTPDVYVIIIW9VSPPFYMEEB9UYVIUKUIZKDUM9LWFIWNKUUKOGEPCAWDQX9KVD9MNXIZNVLJYUIIJ9EK9MWILFTRGYPVKQEVVIS9YZIJHKTCCESMMJNEPLX9U99KJBMQH9KBGBADZJJQA9VULFWRPWBXIFCHFAPQONBMTONQTFJ9DSVC9DRNR9YDIXTIR9EOYIXMHXAGARDMXLDBXFVUCVJYTGIXXMOVGGIZCCY9LINMQEHAPAJFWTKKTCXRMEXJWPEMF9LTXAESYSVXIDFMJKYOIYDOJRPWADWQZNZSWZ9WMVWILFPIHWPRUKAZWNRQXWWCNZ9XDLAMBIRPTJPTOBUH9BJVFMLISNEDAXBDHGCRABTFMGWQKHWISQDVZMBEPZDQRPCRANMXIE9BOSFLSRVOHCLVLGMJGRZZTBWXASMIQTBFDYDMCUSXE9ORCKKLXP9NVUELH9MYAAZFQJHORKNMEVPALBXQLQYLCMTFIAUDNMXZHVZMBDDQGCDZTPCWYFOXXUCQGVTGIOHAGZAMNKTDQVEUDNFYZDRXTJQTQJCCMSQCCNPNTCNGMLDZMJKFZNFLCAGACSFPDTYVCVZDQSWCKJMJJEOBLZIJBOYSJSGALHKRECDYASNOYQAYIGKOOUFNRVOVTXRJE9RPNBWSWXVKCMCKFWNRROTQWIQVUKOVLELCNYJRXDXXAJKFTDGRTKKLVWXAEPDONKPWERJNDXCMPHNHRWBEHPGUBAT99RYSDUMUSBFQVRCBKXIJGDJCYMJVLUYFUIFPXWVPRQSAFICYSWVUOKFTIVABFJEXEURBBFBSSMJDDSGOOEMOCCUQRRYXSGSDNKPTHENISQBY99EWGCZLDNDHWLOI9VGMSLVKCHHMWVZSJQKCVSODAOZCLK9WOXQMHSKXGLGLVUNJECIXXTZCS9GAHZOQ9WBP9QCGEMLAFWPBQE99MR9EEGIL9EDAACBEMBSLAFSQTWFMTILSFGAFKEHEKZSKFSELIKAPPGHXWXTAYKJJRNXHCMJGNXFAXAFTVGAYBRJMMGDS9LOFCBRTETMWHHDZJHUPVPZRSHMCHWHMLHPNL9OJXMSIQWCHPQ9E9UGCIRFITOSFQHWEFLDXEKU9ZPEAU9IVFFFHCGFZFMBSLKUWGKRCNSTPMDZ9TNJDTFLUQSFCWIWVJXAFNQHJQIBIGP9NYHQVIFFFULAIURMRTUMNOSAXSBDSAPN9SVEJI9QTDVRIASKEDQRORVCZYKPNZFBGXHXAVQCNBNZBQBSUHZNI9RRIGVOSQUEONFEKOBE99NDE9OF9TKGWJMHMMWE9UPTGSYCXBTPHEEKDQLHLONZCHZNIQPPBIXEZWMDLMUGCVXZCDGOJMJJAVEXGBPDHZPEVNYJVFZRHSYKU9SLLVPLHKKEFKTZDXLCVGUZLECSFODFOCUHDYEYMV9MXQHGDDV9QPJN9OIBMXR9WO9IYYOBLUUMB99LMATNTSJPHCBDGULUSHUION9MYFHKWUTMHVLJIOJTNUIFZSC9RQNLMQWZDPZTHUKICAOGTDRIZJJBPLQLAYZSTNFPIHRQPZYPAAUWXPTSKV9KVHJEQCDAMEZLHO9TRCIPPCXKBXAWJXBTK9KLEOFRSL9ONMSWLGGMK9LOUAHEPBQL9KHTXLEE9LLYTRYWHFXZSDUZRWVTEKYZKXHYDGSHPRJQUDVOPEWMJPWTWNNJGNMMCGHTYVR9VIFIGBDQPGFOZXCRPUFIEXNZAD9FWAHECMRDAAMKEL9WYBNWYRHERNPEECSYOR9KNRFKZDWDUBGWMAKFZQNFUHIUAYASHMSAGEJLTRNESGGLHCZZVIHVGMQGKCNEALJCIBRXILYWWTZ9LWPSFMUNXDZKZEAPRTH9NGFZHBCMZW9XITMHETOUWEOABPOMLOELGGRGXSTKGQ9VRFMAYOTQDVHN");
});

test("privateKeyFromSubseed() returns correct hashed version of trits security level 2", () => {
    const res = privateKeyFromSubseed(TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"), 2);
    expect(TrytesHelper.fromTrits(res)).toBe("DRAORNOROUYSLTULDTBUSROKZFFXLXIUAPNFGDLEFSOYELCPMGITXGVTEDTZTMAOI9ZSYNNTUROHXDFFWMRKNXIQDLYYDHTWUONUJQYWRWIIWFXBNZPJBPNFRTCNJBRXCOWPXCXTJJGYMIT9HPVMXCJL9HOO9MXCNAZTGAUQHBBGAUDPWQNBXUQVVEVSFLZTSPGSVFBDDPHDCKUJBTYYCDBKSHCOELWNOULGZQAPZZNKOVQFYTGN9EEZVMXSIN9PZSTPDVYVIIIW9VSPPFYMEEB9UYVIUKUIZKDUM9LWFIWNKUUKOGEPCAWDQX9KVD9MNXIZNVLJYUIIJ9EK9MWILFTRGYPVKQEVVIS9YZIJHKTCCESMMJNEPLX9U99KJBMQH9KBGBADZJJQA9VULFWRPWBXIFCHFAPQONBMTONQTFJ9DSVC9DRNR9YDIXTIR9EOYIXMHXAGARDMXLDBXFVUCVJYTGIXXMOVGGIZCCY9LINMQEHAPAJFWTKKTCXRMEXJWPEMF9LTXAESYSVXIDFMJKYOIYDOJRPWADWQZNZSWZ9WMVWILFPIHWPRUKAZWNRQXWWCNZ9XDLAMBIRPTJPTOBUH9BJVFMLISNEDAXBDHGCRABTFMGWQKHWISQDVZMBEPZDQRPCRANMXIE9BOSFLSRVOHCLVLGMJGRZZTBWXASMIQTBFDYDMCUSXE9ORCKKLXP9NVUELH9MYAAZFQJHORKNMEVPALBXQLQYLCMTFIAUDNMXZHVZMBDDQGCDZTPCWYFOXXUCQGVTGIOHAGZAMNKTDQVEUDNFYZDRXTJQTQJCCMSQCCNPNTCNGMLDZMJKFZNFLCAGACSFPDTYVCVZDQSWCKJMJJEOBLZIJBOYSJSGALHKRECDYASNOYQAYIGKOOUFNRVOVTXRJE9RPNBWSWXVKCMCKFWNRROTQWIQVUKOVLELCNYJRXDXXAJKFTDGRTKKLVWXAEPDONKPWERJNDXCMPHNHRWBEHPGUBAT99RYSDUMUSBFQVRCBKXIJGDJCYMJVLUYFUIFPXWVPRQSAFICYSWVUOKFTIVABFJEXEURBBFBSSMJDDSGOOEMOCCUQRRYXSGSDNKPTHENISQBY99EWGCZLDNDHWLOI9VGMSLVKCHHMWVZSJQKCVSODAOZCLK9WOXQMHSKXGLGLVUNJECIXXTZCS9GAHZOQ9WBP9QCGEMLAFWPBQE99MR9EEGIL9EDAACBEMBSLAFSQTWFMTILSFGAFKEHEKZSKFSELIKAPPGHXWXTAYKJJRNXHCMJGNXFAXAFTVGAYBRJMMGDS9LOFCBRTETMWHHDZJHUPVPZRSHMCHWHMLHPNL9OJXMSIQWCHPQ9E9UGCIRFITOSFQHWEFLDXEKU9ZPEAU9IVFFFHCGFZFMBSLKUWGKRCNSTPMDZ9TNJDTFLUQSFCWIWVJXAFNQHJQIBIGP9NYHQVIFFFULAIURMRTUMNOSAXSBDSAPN9SVEJI9QTDVRIASKEDQRORVCZYKPNZFBGXHXAVQCNBNZBQBSUHZNI9RRIGVOSQUEONFEKOBE99NDE9OF9TKGWJMHMMWE9UPTGSYCXBTPHEEKDQLHLONZCHZNIQPPBIXEZWMDLMUGCVXZCDGOJMJJAVEXGBPDHZPEVNYJVFZRHSYKU9SLLVPLHKKEFKTZDXLCVGUZLECSFODFOCUHDYEYMV9MXQHGDDV9QPJN9OIBMXR9WO9IYYOBLUUMB99LMATNTSJPHCBDGULUSHUION9MYFHKWUTMHVLJIOJTNUIFZSC9RQNLMQWZDPZTHUKICAOGTDRIZJJBPLQLAYZSTNFPIHRQPZYPAAUWXPTSKV9KVHJEQCDAMEZLHO9TRCIPPCXKBXAWJXBTK9KLEOFRSL9ONMSWLGGMK9LOUAHEPBQL9KHTXLEE9LLYTRYWHFXZSDUZRWVTEKYZKXHYDGSHPRJQUDVOPEWMJPWTWNNJGNMMCGHTYVR9VIFIGBDQPGFOZXCRPUFIEXNZAD9FWAHECMRDAAMKEL9WYBNWYRHERNPEECSYOR9KNRFKZDWDUBGWMAKFZQNFUHIUAYASHMSAGEJLTRNESGGLHCZZVIHVGMQGKCNEALJCIBRXILYWWTZ9LWPSFMUNXDZKZEAPRTH9NGFZHBCMZW9XITMHETOUWEOABPOMLOELGGRGXSTKGQ9VRFMAYOTQDVHNSPASVJBWTPNJDALIMQKNXZZKADO9RGOCBXEZLCPWHMXTJIBHMHYZPST9MSTGHXHOKPAYHSGAXEQNERCRBZUNAOKHCDXZUAAL9SYBHATRPBAQSSIG9CXTRIOSEWYIYBRBFSJTKYVJKSRVNHIYJMGQIHELSBKBCFINVUJVHYVER9PQLOENGXTUKRS9XGZZCOKUQIQTZFFXNPGTIHNCRNIZRFSIWJXYFDZUBISVXCXT9AAOGOLGRLVRVNEZZGECEGUEFJSPLVWM9QGNCARWJPFZBAWMJVXTXRYWQQUTLFJEHWEKYUJTHLRUYXMYEFYNOPGC9NOMIJEPBABTT9XHPIFJXYL9MRBWQHYBOWBZFQMWDJGDV9RMFQSHHPDDOMJQTCWVVZWMUVINMKTKFOJIXGTGDWAGZUUEUMKZ9SPAFZCSJVAFVKWXVWIAFXYTUFZKWHPNZQTMNUDLAUIDIFYHHL9PTBDXTZWVNHWGQHGLWORUTQ9HAXEJQQEQFDCFOEKVATMINNMIQGACLZTMQDONEDBINRAJXKVNKXEPS9HLUOPRPDUFORRGATGXN9FHXNZSTKZTK9LMLOGGIVALGBBQV9TRVWFQAFNSOTXPGGMNHNDCGWXEJQUSD9IOWZTNSRRFFPREJAMCXPAUCZDROGZLZDW9FZXQOELEGTJPDREGXDLCVBWSLBUZ9CVEEFPLLETDHJQQGTXCFZSTJZAXOT9QQDOKSROTKFYXX9LCZW9ASWOJQSKLLPWWOSNVSEDFZHYSTMSQGWANKIQFWN9YCTDADZXF9OMLKNXNHPQHFEXXDRFTQMNTU9HXIARXAJSAODLEC9DBBXEENSIYDY9SXAWXTP9KHYHQJZJXRMZKNUWQWPC9HSJTURFXYFLHGRMTXQXQPJGQSGSBUV9UYGWNHBCR9QZACPYJRGFEFGKQ9CUHUPCYUBNV9ZFXTIHYBOJUPFQOIFTMLYVUMSNN9J9HQAJDHJNTNSYFDEMJGW9B9KGHDTOPS9X9SCZRJTEDDLBLOVSU9SJCV9AYMLBUTHVEMCOUGZJEEHXKWRUQJXCTQAIBGUTITSOOUUEJMILIWLQOBNEYPSQ9BRBZHPKLOHTKVWGJZLDWP9VC9TJCRJAYKE9PLUN9VCRJWFHJ9SJQVVDTDSJVK9JXCCMFJLWFJJRBSCNLGBAONNDHLIONJELUAVLQPERRTQEJQJALBTNXESXEQPKRMYGPWDIUHLWMBRCCSQBI9XWXS9WBCJTQUEDSBKDIPRG9PJFEQ9FZD9SJUKVMFKNIKFPMPKWJGMKAHWDBSQWPANAPVLHJYBWMURTOLWULRLIINMXTMIKGFVMZZMQARAHKB9DSUDALKSQQJLLWTGTKNH9JPMSCFULVSWKTUIIOCAATOXDJRIFHFMSLKEBPJFSLLUPVHTZFBSGGJQNZQEOLNFWZGLALUQYPGBZNGW9WCDGKRFQAVPZBRGIGFPBITRJNFHVXZEAAGBFCBJMNDCDGTQUH9WZEWTXLDBK9CPWSUV9GRIMFDBRLLFCJELGADLPECOFXSIAJDIKGQZAPFAWOVCMGBG9NXJDIUQCIYUPVOMCS9WMAQJFZDVDOXFIPDRPNKJNGSGCHQAKSYBZ9OMRNFPXTKSMYHMKJURULK9VPCTPDMQFQXAXCVJRYRJEHPWOHIQEKACETCIMQNIWVFGNMMZPWMPJCQAUJRWMJVNPKNOUFPWDCRAPTMATTQVEJ9EFTCUWCVRKODPC9OEEVEUCOPEUOUPPSFAYFUKVRBOPDHVUJHFFFRBU9JYAZMFYKRNIHN9URKKONSRYKJC9SQMTFUWWLRGHBKCMDPDJVBZMFJMOYTLSRCKMZBYJDVEYILMZDKWUEVPKNIVHIPNKJAVSLRQMOCMQTAZLGILVIKMHXNUGWINHQEARXXDMPEQT9JCOOVZUIBUQXUPVBDSAKDEZPVG9WXNDOFBZGBKSRZJSRGUGRWNKHNRZJ9QTIJRABUEUV9ZKQO9LQDIDI9GAX9EJBKYHGBZMHCTQNWV9THPXRBWFNDFIQFKWSJSHVQEQCDIYKWJZHORPYAAMUEOPSXMZUBO9OCQCJCTFYNHUOV9OMAQFKHMLJGPLFBTRFMFULJIIYUBSINXNTQQJYLYIRKLLJRERKLFNGXGQWCTACZRKWBVOOITJCQIXCBFNGODOCQRCPKWXIYUFPOORDMG9");
});

test("privateKeyFromSubseed() returns correct hashed version of trits security level 3", () => {
    const res = privateKeyFromSubseed(TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"), 3);
    expect(TrytesHelper.fromTrits(res)).toBe("DRAORNOROUYSLTULDTBUSROKZFFXLXIUAPNFGDLEFSOYELCPMGITXGVTEDTZTMAOI9ZSYNNTUROHXDFFWMRKNXIQDLYYDHTWUONUJQYWRWIIWFXBNZPJBPNFRTCNJBRXCOWPXCXTJJGYMIT9HPVMXCJL9HOO9MXCNAZTGAUQHBBGAUDPWQNBXUQVVEVSFLZTSPGSVFBDDPHDCKUJBTYYCDBKSHCOELWNOULGZQAPZZNKOVQFYTGN9EEZVMXSIN9PZSTPDVYVIIIW9VSPPFYMEEB9UYVIUKUIZKDUM9LWFIWNKUUKOGEPCAWDQX9KVD9MNXIZNVLJYUIIJ9EK9MWILFTRGYPVKQEVVIS9YZIJHKTCCESMMJNEPLX9U99KJBMQH9KBGBADZJJQA9VULFWRPWBXIFCHFAPQONBMTONQTFJ9DSVC9DRNR9YDIXTIR9EOYIXMHXAGARDMXLDBXFVUCVJYTGIXXMOVGGIZCCY9LINMQEHAPAJFWTKKTCXRMEXJWPEMF9LTXAESYSVXIDFMJKYOIYDOJRPWADWQZNZSWZ9WMVWILFPIHWPRUKAZWNRQXWWCNZ9XDLAMBIRPTJPTOBUH9BJVFMLISNEDAXBDHGCRABTFMGWQKHWISQDVZMBEPZDQRPCRANMXIE9BOSFLSRVOHCLVLGMJGRZZTBWXASMIQTBFDYDMCUSXE9ORCKKLXP9NVUELH9MYAAZFQJHORKNMEVPALBXQLQYLCMTFIAUDNMXZHVZMBDDQGCDZTPCWYFOXXUCQGVTGIOHAGZAMNKTDQVEUDNFYZDRXTJQTQJCCMSQCCNPNTCNGMLDZMJKFZNFLCAGACSFPDTYVCVZDQSWCKJMJJEOBLZIJBOYSJSGALHKRECDYASNOYQAYIGKOOUFNRVOVTXRJE9RPNBWSWXVKCMCKFWNRROTQWIQVUKOVLELCNYJRXDXXAJKFTDGRTKKLVWXAEPDONKPWERJNDXCMPHNHRWBEHPGUBAT99RYSDUMUSBFQVRCBKXIJGDJCYMJVLUYFUIFPXWVPRQSAFICYSWVUOKFTIVABFJEXEURBBFBSSMJDDSGOOEMOCCUQRRYXSGSDNKPTHENISQBY99EWGCZLDNDHWLOI9VGMSLVKCHHMWVZSJQKCVSODAOZCLK9WOXQMHSKXGLGLVUNJECIXXTZCS9GAHZOQ9WBP9QCGEMLAFWPBQE99MR9EEGIL9EDAACBEMBSLAFSQTWFMTILSFGAFKEHEKZSKFSELIKAPPGHXWXTAYKJJRNXHCMJGNXFAXAFTVGAYBRJMMGDS9LOFCBRTETMWHHDZJHUPVPZRSHMCHWHMLHPNL9OJXMSIQWCHPQ9E9UGCIRFITOSFQHWEFLDXEKU9ZPEAU9IVFFFHCGFZFMBSLKUWGKRCNSTPMDZ9TNJDTFLUQSFCWIWVJXAFNQHJQIBIGP9NYHQVIFFFULAIURMRTUMNOSAXSBDSAPN9SVEJI9QTDVRIASKEDQRORVCZYKPNZFBGXHXAVQCNBNZBQBSUHZNI9RRIGVOSQUEONFEKOBE99NDE9OF9TKGWJMHMMWE9UPTGSYCXBTPHEEKDQLHLONZCHZNIQPPBIXEZWMDLMUGCVXZCDGOJMJJAVEXGBPDHZPEVNYJVFZRHSYKU9SLLVPLHKKEFKTZDXLCVGUZLECSFODFOCUHDYEYMV9MXQHGDDV9QPJN9OIBMXR9WO9IYYOBLUUMB99LMATNTSJPHCBDGULUSHUION9MYFHKWUTMHVLJIOJTNUIFZSC9RQNLMQWZDPZTHUKICAOGTDRIZJJBPLQLAYZSTNFPIHRQPZYPAAUWXPTSKV9KVHJEQCDAMEZLHO9TRCIPPCXKBXAWJXBTK9KLEOFRSL9ONMSWLGGMK9LOUAHEPBQL9KHTXLEE9LLYTRYWHFXZSDUZRWVTEKYZKXHYDGSHPRJQUDVOPEWMJPWTWNNJGNMMCGHTYVR9VIFIGBDQPGFOZXCRPUFIEXNZAD9FWAHECMRDAAMKEL9WYBNWYRHERNPEECSYOR9KNRFKZDWDUBGWMAKFZQNFUHIUAYASHMSAGEJLTRNESGGLHCZZVIHVGMQGKCNEALJCIBRXILYWWTZ9LWPSFMUNXDZKZEAPRTH9NGFZHBCMZW9XITMHETOUWEOABPOMLOELGGRGXSTKGQ9VRFMAYOTQDVHNSPASVJBWTPNJDALIMQKNXZZKADO9RGOCBXEZLCPWHMXTJIBHMHYZPST9MSTGHXHOKPAYHSGAXEQNERCRBZUNAOKHCDXZUAAL9SYBHATRPBAQSSIG9CXTRIOSEWYIYBRBFSJTKYVJKSRVNHIYJMGQIHELSBKBCFINVUJVHYVER9PQLOENGXTUKRS9XGZZCOKUQIQTZFFXNPGTIHNCRNIZRFSIWJXYFDZUBISVXCXT9AAOGOLGRLVRVNEZZGECEGUEFJSPLVWM9QGNCARWJPFZBAWMJVXTXRYWQQUTLFJEHWEKYUJTHLRUYXMYEFYNOPGC9NOMIJEPBABTT9XHPIFJXYL9MRBWQHYBOWBZFQMWDJGDV9RMFQSHHPDDOMJQTCWVVZWMUVINMKTKFOJIXGTGDWAGZUUEUMKZ9SPAFZCSJVAFVKWXVWIAFXYTUFZKWHPNZQTMNUDLAUIDIFYHHL9PTBDXTZWVNHWGQHGLWORUTQ9HAXEJQQEQFDCFOEKVATMINNMIQGACLZTMQDONEDBINRAJXKVNKXEPS9HLUOPRPDUFORRGATGXN9FHXNZSTKZTK9LMLOGGIVALGBBQV9TRVWFQAFNSOTXPGGMNHNDCGWXEJQUSD9IOWZTNSRRFFPREJAMCXPAUCZDROGZLZDW9FZXQOELEGTJPDREGXDLCVBWSLBUZ9CVEEFPLLETDHJQQGTXCFZSTJZAXOT9QQDOKSROTKFYXX9LCZW9ASWOJQSKLLPWWOSNVSEDFZHYSTMSQGWANKIQFWN9YCTDADZXF9OMLKNXNHPQHFEXXDRFTQMNTU9HXIARXAJSAODLEC9DBBXEENSIYDY9SXAWXTP9KHYHQJZJXRMZKNUWQWPC9HSJTURFXYFLHGRMTXQXQPJGQSGSBUV9UYGWNHBCR9QZACPYJRGFEFGKQ9CUHUPCYUBNV9ZFXTIHYBOJUPFQOIFTMLYVUMSNN9J9HQAJDHJNTNSYFDEMJGW9B9KGHDTOPS9X9SCZRJTEDDLBLOVSU9SJCV9AYMLBUTHVEMCOUGZJEEHXKWRUQJXCTQAIBGUTITSOOUUEJMILIWLQOBNEYPSQ9BRBZHPKLOHTKVWGJZLDWP9VC9TJCRJAYKE9PLUN9VCRJWFHJ9SJQVVDTDSJVK9JXCCMFJLWFJJRBSCNLGBAONNDHLIONJELUAVLQPERRTQEJQJALBTNXESXEQPKRMYGPWDIUHLWMBRCCSQBI9XWXS9WBCJTQUEDSBKDIPRG9PJFEQ9FZD9SJUKVMFKNIKFPMPKWJGMKAHWDBSQWPANAPVLHJYBWMURTOLWULRLIINMXTMIKGFVMZZMQARAHKB9DSUDALKSQQJLLWTGTKNH9JPMSCFULVSWKTUIIOCAATOXDJRIFHFMSLKEBPJFSLLUPVHTZFBSGGJQNZQEOLNFWZGLALUQYPGBZNGW9WCDGKRFQAVPZBRGIGFPBITRJNFHVXZEAAGBFCBJMNDCDGTQUH9WZEWTXLDBK9CPWSUV9GRIMFDBRLLFCJELGADLPECOFXSIAJDIKGQZAPFAWOVCMGBG9NXJDIUQCIYUPVOMCS9WMAQJFZDVDOXFIPDRPNKJNGSGCHQAKSYBZ9OMRNFPXTKSMYHMKJURULK9VPCTPDMQFQXAXCVJRYRJEHPWOHIQEKACETCIMQNIWVFGNMMZPWMPJCQAUJRWMJVNPKNOUFPWDCRAPTMATTQVEJ9EFTCUWCVRKODPC9OEEVEUCOPEUOUPPSFAYFUKVRBOPDHVUJHFFFRBU9JYAZMFYKRNIHN9URKKONSRYKJC9SQMTFUWWLRGHBKCMDPDJVBZMFJMOYTLSRCKMZBYJDVEYILMZDKWUEVPKNIVHIPNKJAVSLRQMOCMQTAZLGILVIKMHXNUGWINHQEARXXDMPEQT9JCOOVZUIBUQXUPVBDSAKDEZPVG9WXNDOFBZGBKSRZJSRGUGRWNKHNRZJ9QTIJRABUEUV9ZKQO9LQDIDI9GAX9EJBKYHGBZMHCTQNWV9THPXRBWFNDFIQFKWSJSHVQEQCDIYKWJZHORPYAAMUEOPSXMZUBO9OCQCJCTFYNHUOV9OMAQFKHMLJGPLFBTRFMFULJIIYUBSINXNTQQJYLYIRKLLJRERKLFNGXGQWCTACZRKWBVOOITJCQIXCBFNGODOCQRCPKWXIYUFPOORDMG9VWZJNFKOAJTZ9CPFOTIXJQXOUVIAHNLXBPDRMFQRIIQYVJTESGVDDLUWBCZHIMDBGZWWLCNYGECPDXYRYV9DZNRRAKDOAXVSALRDFBPYNFETXGZAMPCGEJBUEIYJE9WUHUZBVH9AMPIFRXNSRRMSFECRNBRAYBEQMQWUAOSE9N9XTTNAATTZBZUZCZIZHYUMAVONXVHYYXQPHFASLMXQCUYEBWUMQBLHUEOPQUUDSCWAITBIZNGL9IJSRLNCRIHUOBPQAMO9JY9XNDNFWYNPKSGJRIM9OERYWJAPOYUTOPSNFJ9VBWBTLMTFVXFIWGFPH9TYJIZOWGLCN9WROGESZDOVDHQCUNQZDJEEUQITBFUBKRVP9XMQBONZVUUMORICVYYVIASSKICZGMVUARQYPRYJWMRFJPD9ZOUFRTIAHXBHMGCBMQOWGVFFLDKDHOYTVRGX9ZNMZZRKOUQZTSGCCPLHUPSODGYKTPICEHBLFAVBZCOZLAGVVLXFGKIBYYMLZYSSUMZEICLWKOBYKVQCAPVQPORTZWRYEPTZEBV9X99WGOOQPBTXPNYTRJCWYEJE9UNBLJHXUIQOSQMRRTAYTOIBEWFN9YVRDSHQCL9YBQLXIGTSOULZCWS9PWWGDNDMJKKOWPRZZYJWJSKQXYQVPYVUSGEN9EWGUQTINHAGFYEGSEXPOY9COVCTNPOXGCKSALYZZMCPHNUALQ9IUSUIKFACYCBFSDLYMTYDHKEDGPWGLGXIJE9DPZOXG9HYDTHWFMMYRTJYDGIVA9JOHXUMTZWYYH9GUG9GU9QMDWUUNXTGZCVKLUHOIKBLRBCKHICCNPAXOTC9LRPVSOLITKKPNG9FJP9CRJEKZW9T9LKZYTOLDIOQZBPUMVA9SIRQTYM9WGMKDTQUVCBCQOJAXBZOI9PFSKIASGPWJEFG9DCNQJUBRBSPYHXWMFCSQPGBZ9TBKCOMHUDIMZGVQNYPZZEOVIMWGJVU9ZFNLNAIZOUKCQETWCXWKWEMGZVZGAFB9BJYUZJXCFGVDUKOT9RHJBIMSYPHEYQQKVPSUNCRRSCARNWKLSBNEVVITMVQXSQINQBESLTDUUMQKTETSVUTPFSGYXNZBMSGVYWNIUVVMGORA9XTQBXZXZSPCECDJPRBIBKEULQDMRWOYQXKZCFXZWYU9SUQZJOAKJOSNTSTRKBDJRHEJFCXDZLXEPYOJNMDXQKWASPRTGYYDVVMCNRKGFOFBEJFAFCGEZHJHYALQQBAHBELIWJQWTVPVAMAZOQJCGOUCHRDMNGDLIGXFGLCBYU9DSHFZTWGYLONYWODPAASAP9ENMZECTKVJXQIIKRXMLGFEWERJGDFXEHKN9RCC9I9UQEMOYBNJQDIFLVCATV9JDMHCNVWLDJZOQLIWZGK9GTAJTJFDNCEXUWALGJLPLNPOSHLQZH9JQPJUKNVJSUACGTIMLMDZKZFIMGJYLKRQHMQCEJEW9VGOPMUKXPDHVWNEPTDADFCHGGOSNKNLTHBCQAQ9Z9KPBDVTB9XIVUAMFRTIQKPQQJJTBEP9HUIMLBDBHVYMAFCQHLBIENQPOUKGTQIAIAXQXTHPNXAZZOVFZVMTEPYASSD9BHOLQIRKOXVKCUBVXWD9YTLIRNT9Z9VUMCOUDTGIJEXXXABEZZCZ9QNSWSOKZLACAEBVCNOVXWJFQQRLWBICDDWGLMFHGEANERBYENHXUCTTRHKBDIQCETVUVPCBMIQLBAXFUHRSPXVOREADETBCKWQKQUQZ9PI9FESEZZEBVUELUXGKWZKVZNGVL9STSNZOTO9KFAVACQAKHMJDAHNJIEAULBLIHNTPWDXHKJMRXWYKZODHRZANYR9CWYXSARTCRIUPPPKIUVGROWRSMWOCZQDFRBGQZRTJSMZYNHRKOHOIIQBDJHYQY9JTRLJRINVTMQWMAVPKPOBACAYRQIXWIJZDFLZMLACWFJJQTCO9TGANBTYEULIWXGMBNIKE99KIIJTHWLRBBRVGOLXEPGOUXYNP9MVAELZXEWWXGJMGUTEONZRXRFDKCULNPQEUHPRPXKVKYIJHCIX9KYVGGRAVJKMTFLKRMIMSGFYUOBCJLASTBHQJNWJACFVOBPEWUXTTNNBCHXRWFHDANXINGUYOSNTRI9FTOEC9ZWVHLZDZISVOGVLLOG9QHMSZHWNNHZJHBT");
});

test("signature() returns correct hashed version of trits", () => {
    const res = signature(
        TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"),
        TrytesHelper.toTrits("A".repeat(81)));
    expect(TrytesHelper.fromTrits(res)).toBe("MVCTKZFR9JBYYGKQXS9PMZ9QYALUIDTDWHQPZKI9XDYOHWSC9FZBRAVRHNEXA9A9ZCVAIXS9PLTSDF9SB");
});

test("signature() returns correct hashed version of trits double length key", () => {
    const res = signature(
        TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"),
        TrytesHelper.toTrits("A".repeat(162)));
    expect(TrytesHelper.fromTrits(res)).toBe("MVCTKZFR9JBYYGKQXS9PMZ9QYALUIDTDWHQPZKI9XDYOHWSC9FZBRAVRHNEXA9A9ZCVAIXS9PLTSDF9SBGRXHGNUHVKNODWHZEXPUTWUZERKCCJ9DWYLXVOOQGWUFSPJGUKYGL9ICQMSHUMUMXNLZOOTMFGKVRKUNN");
});

test("checksumSecurity() returns security level 1", () => {
    const arr = new Int8Array(81);
    arr.fill(0);
    const res = checksumSecurity(arr);
    expect(res).toBe(1);
});

test("checksumSecurity() returns security level 2", () => {
    const arr = new Int8Array(162);
    arr.fill(0);
    arr[0] = 1;
    arr[82] = -1;
    const res = checksumSecurity(arr);
    expect(res).toBe(2);
});

test("checksumSecurity() returns security level 3", () => {
    const arr = new Int8Array(243);
    arr.fill(0);
    arr[0] = 1;
    arr[1] = 1;
    arr[82] = -1;
    arr[164] = -1;
    const res = checksumSecurity(arr);
    expect(res).toBe(3);
});

test("checksumSecurity() returns security level 0", () => {
    const arr = new Int8Array(243);
    arr.fill(0);
    arr[0] = 1;
    const res = checksumSecurity(arr);
    expect(res).toBe(0);
});

test("digestFromSignature() returns correct hashed version of trits", () => {
    const res = digestFromSignature(
        TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"),
        TrytesHelper.toTrits("A".repeat(81)));
    expect(TrytesHelper.fromTrits(res)).toBe("KR9VGZNJMJZLNBKTJ9JMKLQRJPDKCTCJZLYVRKCNRCNAIQIFRPGMBBTFGWSVZGKXZCYUGGSSVPIMQHLVI");
});

test("digestFromSignature() returns correct hashed version of trits double length", () => {
    const res = digestFromSignature(
        TrytesHelper.toTrits("XAL9SMWRVVMYNSIIUVHXH9LBAHYHUWXRRKOTWECQULPRVVHMJXIIHAKPMZZGUFQPJNNAWBRUMZMRLFXNP"),
        TrytesHelper.toTrits("A".repeat(162)));
    expect(TrytesHelper.fromTrits(res)).toBe("SMKEXRDFQCJDYQUUUOMBX9IFKGHPVC9GJRGSTWWEXRJJWOFSGXSTZMCVDPPRWLSYVBAUONMXEDYSIZ9FF");
});
